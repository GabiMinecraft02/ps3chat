<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>PS3 Chat</title>
  <style>
    body {
      background:#111;
      color:white;
      display:flex;
      justify-content:center;
      align-items:center;
      height:100vh;
      font-family:sans-serif;
    }
    input, button {
      padding:10px;
      margin-top:10px;
      width:100%;
    }
  </style>
</head>
<body>

<h2>Entrer un pseudo</h2>
<input id="pseudo">
<button onclick="join()">Entrer</button>

<div id="chat" style="display:none;">
  <div id="messages"></div>
  <input id="msg">
  <button onclick="send()">Envoyer</button>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();
let myPseudo = "";

function join() {
  const p = document.getElementById("pseudo").value.trim();
  if (!p) return alert("Pseudo obligatoire");

  myPseudo = p;
  socket.emit("join", { pseudo: p });
}

socket.on("joined", () => {
  document.getElementById("chat").style.display = "block";
});

socket.on("message", m => {
  const div = document.createElement("div");
  div.textContent = `[${m.time}] ${m.pseudo}: ${m.text}`;
  document.getElementById("messages").appendChild(div);
});

function send() {
  const text = document.getElementById("msg").value;
  socket.emit("message", { pseudo: myPseudo, text });
}
</script>

</body>
</html>
